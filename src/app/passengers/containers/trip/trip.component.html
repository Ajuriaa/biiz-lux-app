<app-shared-loading class="loading" *ngIf="loading"></app-shared-loading>

<div class="container">
  <div class="map" #map></div>
  <app-shared-header class="header"></app-shared-header>
  <div class="button-container" [ngClass]="{'animate': travelConfirmed}">
    <div class="autocomplete">
      <div class="autocomplete-img">
        <img class="logo" src="assets/images/location-arrows.svg">
      </div>
      <div class="input-wrapper">
        <form [formGroup]="addressForm">
          <div class="form-field">
            <input
              [(ngModel)]="autocompleteCurrent.input"
              [readonly]="travelConfirmed"
              (input)="UpdateSearchResults(autocompleteCurrent)"
              placeholder="Dirección actual"
              formControlName="startAddress"
              class="input"
              required
            >
            <ion-icon class="icon" name="close" *ngIf="!travelConfirmed" (click)="ClearAutocomplete()"></ion-icon>
          </div>
          <mat-list *ngIf="autocompleteCurrentAddresses.length !== 0 && !travelConfirmed">
            <mat-list-item *ngFor="let item of autocompleteCurrentAddresses" tappable (click)="SelectSearchResult(item.description)">
              {{ item.description }}
            </mat-list-item>
          </mat-list>
          <div class="form-field">
            <input
              [(ngModel)]="autocompleteDestination.input"
              [readonly]="travelConfirmed"
              (input)="UpdateSearchResults(autocompleteDestination, true)"
              placeholder="Dirección de destino"
              formControlName="endAddress"
              class="input"
              required
            >
            <ion-icon class="icon" name="close" *ngIf="!travelConfirmed" (click)="ClearAutocomplete(true)"></ion-icon>
          </div>
          <div *ngIf="autocompleteDestinationAddresses.length !== 0  && !travelConfirmed">
            <p *ngFor="let item of autocompleteDestinationAddresses" (click)="SelectSearchResult(item.description, true)">
              {{ item.description }}
            </p>
          </div>
        </form>
      </div>
    </div>
    <div [@inAnimation] class="driver-container" *ngIf="!driverSelected && travelConfirmed">
      <app-available-drivers (selected)="selectDriver($event)"></app-available-drivers>
    </div>
    <div [@inAnimation] class="selected" *ngIf="driverSelected && travelConfirmed" >
      <app-driver-card class="driver" [driver]="selectedDriver" [unique]="true"></app-driver-card>
      <app-primary-button class="confirm" (btnClick)="startTrip()" [showLogo]="true">
        CONFIRMAR VIAJE
      </app-primary-button>
    </div>
    <div class="options" *ngIf="!travelConfirmed">
      <app-secondary-button class="btn">EVENTOS</app-secondary-button>
      <app-secondary-button class="btn">PROGRAMAR</app-secondary-button>
    </div>
    <app-primary-button class="confirm" (btnClick)="submit()" *ngIf="!travelConfirmed" [showLogo]="true">
      CONFIRMAR DESTINO
    </app-primary-button>
  </div>
</div>
